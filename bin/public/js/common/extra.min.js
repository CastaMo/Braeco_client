/*! braeco_client 2015-11-26 */
!function(a,b){"function"==typeof define&&define.amd?define([],b):"undefined"!=typeof module&&module.exports?module.exports=b():a.ReconnectingWebSocket=b()}(this,function(){function a(b,c,d){function e(a,b){var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,!1,!1,b),c}var f={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3};d||(d={});for(var g in f)this[g]="undefined"!=typeof d[g]?d[g]:f[g];this.url=b,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var h,i=this,j=!1,k=!1,l=document.createElement("div");l.addEventListener("open",function(a){i.onopen(a)}),l.addEventListener("close",function(a){i.onclose(a)}),l.addEventListener("connecting",function(a){i.onconnecting(a)}),l.addEventListener("message",function(a){i.onmessage(a)}),l.addEventListener("error",function(a){i.onerror(a)}),this.addEventListener=l.addEventListener.bind(l),this.removeEventListener=l.removeEventListener.bind(l),this.dispatchEvent=l.dispatchEvent.bind(l),this.open=function(b){h=new WebSocket(i.url,c||[]),b||l.dispatchEvent(e("connecting")),(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",i.url);var d=h,f=setTimeout(function(){(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",i.url),k=!0,d.close(),k=!1},i.timeoutInterval);h.onopen=function(){clearTimeout(f),(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onopen",i.url),i.protocol=h.protocol,i.readyState=WebSocket.OPEN,i.reconnectAttempts=0;var c=e("open");c.isReconnect=b,b=!1,l.dispatchEvent(c)},h.onclose=function(c){if(clearTimeout(f),h=null,j)i.readyState=WebSocket.CLOSED,l.dispatchEvent(e("close"));else{i.readyState=WebSocket.CONNECTING;var d=e("connecting");d.code=c.code,d.reason=c.reason,d.wasClean=c.wasClean,l.dispatchEvent(d),b||k||((i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onclose",i.url),l.dispatchEvent(e("close")));var f=i.reconnectInterval*Math.pow(i.reconnectDecay,i.reconnectAttempts);setTimeout(function(){i.reconnectAttempts++,i.open(!0)},f>i.maxReconnectInterval?i.maxReconnectInterval:f)}},h.onmessage=function(b){(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",i.url,b.data);var c=e("message");c.data=b.data,l.dispatchEvent(c)},h.onerror=function(b){(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","onerror",i.url,b),l.dispatchEvent(e("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(b){if(h)return(i.debug||a.debugAll)&&console.debug("ReconnectingWebSocket","send",i.url,b),h.send(b);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(a,b){"undefined"==typeof a&&(a=1e3),j=!0,h&&h.close(a,b)},this.refresh=function(){h&&h.close()}}return a.prototype.onopen=function(){},a.prototype.onclose=function(){},a.prototype.onconnecting=function(){},a.prototype.onmessage=function(){},a.prototype.onerror=function(){},a.debugAll=!1,a.CONNECTING=WebSocket.CONNECTING,a.OPEN=WebSocket.OPEN,a.CLOSING=WebSocket.CLOSING,a.CLOSED=WebSocket.CLOSED,a});var util=function(a){"use strict";function b(a,b){if(4===a.readyState&&200===a.status&&"function"==typeof b){var c=a.responseText;b(c)}}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u=null,v=null;return"function"==typeof window.addEventListener?(u=function(a,b,c){a.addEventListener(b,c,!1)},v=function(a,b,c){a.removeEventListener(b,c,!1)}):"function"==typeof a.attachEvent?(u=function(a,b,c){a.attachEvent("on"+b,c)},v=function(a,b,c){a.detachEvent("on"+b,c)}):(u=function(a,b,c){a["on"+b]=c},v=function(a,b,c){a["on"+b]=null}),c=function(a,b){var c,d;return d=new RegExp("(\\s|^)"+b+"(\\s|$)"),c=a.getAttribute("class")?a.className:"",d.test(c)},d=function(a,b){return!a||c(a,b)?a.className?a.className:"":a.className?a.className+=" "+b:a.className=b},e=function(a,b){if(!a)return a.className?a.className:"";var c=new RegExp("(\\s|^)"+b+"(\\s|$)");return a.className=a.className.replace(c," ").replace(/(^\s*)|(\s*$)/g,"")},f=function(a){var c;return c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),c.onreadystatechange=function(){b(c,a.success)},c.open(a.type,a.url,a.async),"POST"===a.type.toUpperCase()&&c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"undefined"!=typeof a.data?c.send(a.data):c.send(),c},g=function(b,d){for(var e=[],f=a.getElementsByTagName(b),g=0,h=f.length;h>g;g++)c(f[g],d)&&e.push(f[g]);return e},h=function(a){return RegExp(/^(0|86|17951)?(13[0-9]|15[012356789]|18[0-9]|14[57])[0-9]{8}$/).test(a)},i=function(a){return a.substr(0,3)+"****"+a.substr(7,4)},j=function(b,c){return c?c.querySelector(b):a.querySelector(b)},k=function(b,c){return c?c.querySelectorAll(b):a.querySelectorAll(b)},l=function(a){var b=a.parentNode;return b.removeChild(a)},m=function(a,b){if("string"==typeof b){var c=a.innerHTML;return a.innerHTML=c+b}return a.appendChild(b)},n=function(a,b){if("string"==typeof b){var c=a.innerHTML;return a.innerHTML=b+c}var d=a.children[0];a.insertBefore(b,d)},o=function(a,b){return c(a,b)?e(a,b):d(a,b)},p=function(a){var b=null;return void 0!==window.createObjectURL?b=window.createObjectURL(a):void 0!==window.URL?b=window.URL.createObjectURL(a):void 0!==window.webkitURL&&(b=window.webkitURL.createObjectURL(a)),b},q=function(a,b){var c,d=Object.prototype.toString;return"Null"===b&&null==a||"Undefined"==b&&Object===c||d.call(a).slice(8,-1)===b},r=function(a,b){for(var c in a){var d=a[c];a!==d&&(q(d,"Object")?b[c]=r(d,b[c]||{}):q(d,"Array")?(b[c]=[],b[c]=r(d,b[c]||[])):b[c]=d)}return b},s=function(b){return a.getElementById(b)},t=function(a){return document.createElement(a)},{addListener:u,removeListener:v,hasClass:c,addClass:d,removeClass:e,ajax:f,getElementsByClassName:g,isPhone:h,hidePhone:i,query:j,querys:k,remove:l,append:m,prepend:n,toggleClass:o,getObjectURL:p,is:q,deepCopy:r,getById:s,createDom:t}}(document);